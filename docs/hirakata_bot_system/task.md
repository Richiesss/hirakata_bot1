# 枚方市民ニーズ抽出ハイブリッドシステム 実装タスク

## フェーズ1: プロジェクト初期セットアップ
- [x] hirakata_bot1ディレクトリの構造確認
- [x] 参照リポジトリhirakata_botの内容調査
- [x] 技術スタック・依存関係の整理
- [x] プロジェクト基本構造の作成

## フェーズ2: データベース設計・実装
- [x] データモデル定義（USERS, OPINIONS, POLL_RESPONSESテーブル）
- [x] PostgreSQLのスキーマ設計
- [x] データベース初期化スクリプト作成
- [x] マイグレーション機能の実装

## フェーズ3: LINE Bot基盤実装
- [x] LINE Messaging API連携の基盤構築
- [ ] リッチメニュー設定
- [x] Webhook受信・ルーティング機能
- [x] ユーザー登録機能（UC-015）
- [x] メッセージ送受信の基本機能

## フェーズ4: Ollama/LLM統合
- [x] Ollama連携モジュール実装
- [x] プロンプトテンプレート設計
  - [x] 対話フェーズ（傾聴・深掘り）
  - [x] 要約・構造化フェーズ
- [ ] 並列処理・キューイング機能
- [ ] レスポンスタイム最適化

## フェーズ5: 市民向け機能実装（対話型）
- [x] UC-001: 対話開始機能
- [x] UC-002: 意見収集対話
- [x] UC-003: 追加質問（深掘り）
- [x] UC-004: 意見要約・構造化
- [x] UC-005: ポイント付与（対話）
- [x] UC-019: 履歴リセット

## フェーズ6: 市民向け機能実装（自由記述アンケート）
- [x] UC-006: アンケート遷移
- [x] UC-007: 自由記述入力フォーム
- [x] UC-008: カテゴリ選択
- [x] UC-009: 送信確認
- [x] UC-010: ポイント付与（自由記述）

## フェーズ7: 市民向け機能実装（選択式アンケート）
- [x] UC-011: アンケート通知配信
- [x] UC-012: 選択肢表示（4択）
- [x] UC-013: 投票機能
- [x] UC-014: ポイント付与（選択式）

## フェーズ8: 市民向けユーティリティ機能
- [ ] UC-016: ポイント確認
- [ ] UC-017: 履歴確認
- [ ] UC-018: 通知設定

## フェーズ9: 管理者向けAI分析機能
- [ ] AD-002: AI自動分類
- [ ] AD-003: クラスタリング
- [ ] AD-004: 優先順位付け
- [ ] AD-005: トレンド分析

## フェーズ10: 管理者向けダッシュボード
- [x] 認証・ログイン機能
- [x] AD-001: 意見集計表示
- [x] AD-006: ダッシュボード画面
- [ ] AD-007: レポート生成（PDF/Excel）
- [x] AD-008: CSV出力
- [x] AD-009: アンケート配信管理
- [ ] AD-010: ポイント管理

## フェーズ11: 非機能要件対応
- [ ] セキュリティ実装
  - [ ] 通信暗号化（HTTPS）
  - [ ] LINE IDハッシュ化
  - [ ] 管理画面多要素認証
- [ ] 性能最適化
  - [ ] 応答時間3秒以内達成
  - [ ] 同時100ユーザー対応
  - [ ] 1日1万件処理対応
- [ ] 可用性対応
  - [ ] ヘルスチェック機能
  - [ ] エラーハンドリング
  - [ ] ログ・モニタリング

## フェーズ12: テスト・検証
- [ ] 単体テスト作成
- [ ] 統合テスト実施
- [ ] 負荷テスト
- [ ] セキュリティテスト
- [ ] ユーザー受け入れテスト準備

## フェーズ13: デプロイ・運用準備
- [ ] Docker/Docker Compose設定
- [ ] 環境設定ファイル整備
- [ ] デプロイメントスクリプト
- [ ] 運用マニュアル作成
- [ ] バックアップ・リストア手順
